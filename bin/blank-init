#! /usr/bin/env bash

# Initialize a new repository. This boils down to `git init --bare`.
#
# Example usage: blank-init hello

REPO_NAME="$1"

echo "blank-int Called with $1" >> /blank/blank.log

if [[ -z "${REPO_NAME}" ]] ; then
  echo "Usage: blank-init REPOSITORY"
  exit 1
fi

REPO_BASENAME=$(basename -- "${REPO_NAME}")

if [[ "${REPO_NAME}" != "${REPO_BASENAME}" ]] ; then
  echo "The repository name can't be a path."
  exit 1
fi

git init --bare "/blank/${REPO_NAME}.git"
cat >> "/blank/${REPO_NAME}.git/config" <<EOF
[user]
	email = blank@reesd.com
	name = Hypered Blank
EOF
